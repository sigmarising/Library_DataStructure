# Library System

按照要求，图书馆系统要涉及到对文件进行交互，尽量减少对内存空间的依赖。所以，将所有图书一口气吃到内存里是不可取、不合题意的。所以本文件对开发过程中涉及到文件进行详细解释说明。

## 文件简介

* `books`文件夹存放所有的和书有关的文件。
* `people`文件夹存放所有和人有关的文件。
* `logbook`文件夹存放日志以及其他内容。

### books文件夹

books文件夹下有文件 `booklist.txt` ，这是所有书籍的索引文件。其中包含 有多少种不同的书，以及所有书的ID前缀。 

books文件夹下对于每本书，使用三个文件进行保存。例如，一本书的ID前缀是00000001，一共有相同的书三本，他们的ID号是000000010001至000000010003。那么我们保存`00000001.txt  00000001_books.txt  00000001_subc.txt`，第一个文件存储这种书的各类信息（ID前缀、书名出版社...），第二个文件存储同名的各本书的ID以及其状态，第三个文件存储其预约着名单。

### people文件夹

people文件夹之下有文件 `peoplelist.txt` ，这个文件里有所有的用户的ID信息、权限、登录密码。

对于每个人来说，都有三个文件与之对应，例如一个人的ID是 000000000001，那么创建文件`000000000001.txt  000000000001_books.txt  000000000001_subc.txt`，第一个文件存储人的基本信息和预约队列消息，第二个文件存储人的已经借出的图书列表，第三个文件存储人的预约图书列表。

### logbook文件夹

本文件夹下有很多文件，按照系统天数进行存储，一天一个文件，例如`day1  day2`。

本文件夹下还有一个`sys.txt`文件，其中有系统是否需要初始化，以及管理员密码的信息，还有用于创建新ID的数值。

## 文件详细格式

### book文件夹

以下按照有书籍00000001 00000002来做例子

#### booklist.txt

line 1: 一共的已有的书籍种类数n

line 2_n+1: 一共n行 里面每一行有各种书籍的ID前缀

例如：

    2
    00000001
    00000002

#### 00000001.txt

line 1: ID 前缀

line 2: 书名

line 3: 作者名

line 4: 出版社

line 5: 类别

line 6: 权限（0均可借 1仅学生可借 2仅教师可借）

line 7: 本书总数量

line 8: 已借出数量

line 9: 已预约数量（不包括排队人数）

line 10: 可利用数量

例如：

    00000001
    《算法导论》
    作者某某
    北邮出版社
    计算机类 算法类 学习类
    0
    5
    2
    3
    0

#### 00000001_books.txt

line i: 本书完整ID

line i+1: 本书入库时间

line i+2: 本书借阅者ID

line i+3: 本书状态（0-可借出 1-已借出 2-已预约）

line i+4: 本书借阅剩余天数（借阅状态值<=30 预约状态值=100）

例如：

    000000010001
    day1
    000000000001
    1
    29
    000000010002
    day1
    000000000001
    1
    30
    000000010003
    day1
    000000000003
    2
    100
    000000010004
    day1
    000000000004
    1
    30
    000000010005
    day1
    000000000005
    2
    100

#### 00000001_subc.txt

每一行均为预约排队者的ID信息

例如：

    000000000006
    100000000002
    100000000006

### people文件夹

#### peoplelist.txt

line 1: 已有用户人数n

line i: 用户ID

例如：

    3
    000000000001
    000000000002
    100000000003

#### 000000000001.txt

line 1: ID

line 2: 密码

line 3: 姓名

line 4: 学院

line 5: 权限（0学生 1老师）

line 6: 诚信度 （默认100）

line 7: 欠款 （默认0.0）

line 8: 已借阅数量

line 9: 已预约数量

例如：

    000000000001
    123456
    王二
    计算机院
    0
    100
    0.0
    3
    2

#### 000000000001_books.txt

line i: 图书ID

line i+1: 借阅剩余天数

例如：

    000000010001
    29
    000000020003
    25

#### 000000000001_subc.txt

line i: 预约的图书的ID前缀
line i+1: 是否可以转借阅（0为不可以 1为可以）

例如：

    00000005
    0
    00000009
    1

### logbook文件夹

#### sys.txt

line 1: 系统是否已经初始化 （0没有 1是的）
line 2: 管理员密码
line 3: 已有的学生人数（权限0）
line 4: 已有的教师人数（权限1）
line 5: 已有权限0的图书数
line 6: 已有权限1的图书数
line 7: 已有权限2的图书数

例如：

    1
    admin

#### dayi.txt

需要进行日志记录的有：

* 用户登录
* 用户借阅（预约）
* 用户还书
* 管理员添加人
* 管理员添加书

例如：

    时间_day1
    事件_用户登录 用户名_000000000001
    事件_用户借阅 用户名_000000000001 图书_000000010001
    事件_用户预约 用户名_000000000001 图书_00000008
    事件_新建用户 用户名_000000000011
    事件_新建图书 图书_000000080008

## ID格式说明

人和图书的ID均为12位数值

保留**ID000000000000**作为空值，例如图书无人借阅或预约，则对应人的ID位空值

### 人

第1位表明权限，0为学生1为教师，之后11位为默认的编号值，建立人的时候按照次序递增。

### 书

第一位为权限值（0均可借 1仅学生可借 2仅教师可借），之后7位是编号值，按照已有的图书次序递增，最后4位为第几本，表示本类书的第几本。

## 交互过程说明

1. 系统运行 天数计时系统启动 可以切换手动天数和自动天数 可以退出
2. 登陆 登陆身份可以是学生教师、管理员
3. 登陆后操作
    * 学生教师
        1. 列出个人的各类信息
            * 个人信息值 ID 姓名 学院 诚信 欠款...
            * 如果借了书 列出借书列表 和图书状态
            * 如果预约了书 列出预约列表 和预约状态
        2. 查书 根据用户需要进行查书
            * 根据ID查书
            * 根据书名查书
            * 根据作者查书
            * 根据出版社查书
            * 根据类别查书
        3. 借书或者预约
        4. 预约转借阅（1键操作）
        5. 还书
    * 管理员
        1. 人
            * 建立新人 要求能根据ID判断是否已有此人
            * 查人 只有管理员有权查看所有人的列表信息
        2. 书
            * 建立新书 要求能判断是否加入已有图书还是建立新类别
            * 查书 此功能是列出所有图书列表 一般用户无此权限 只可以根据关键字查书
4. 登出 转到1